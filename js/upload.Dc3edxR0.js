import{d as e,bL as t,bM as l,r as a,I as s,as as i,g as u,f as n,m as r,k as o,i as p,aA as d,w as c,a4 as m,F as f,C as y,E as v,j as g,aG as _,bY as h,e as b,P as j,o as x,h as w}from"./index.CLwcgr5W.js";import{E as k,a as C}from"./form-item.BdtRMIsU.js";import{E as F}from"./upload.DTnb7NYB.js";import{E as S}from"./progress.DJbsQUMK.js";/* empty css               */import{F as V}from"./file-api.BMWh37Mc.js";import{E as z}from"./index.CBGhulza.js";import{_ as M}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{E as O,a as E}from"./image-viewer.C_t9U3xG.js";import{E as I}from"./link.BAAqDnnc.js";import"./use-form-common-props.IVgy7ztC.js";import"./castArray.DrI1MKdu.js";import"./error.D_Dr4eZ1.js";import"./_baseClone.CAv3GKzL.js";import"./index.VqkEunCr.js";import"./index.QOGYTTN0.js";import"./aria.Cpd_B0tV.js";import"./debounce.C60rTEN2.js";import"./toNumber.CXxxQ5rM.js";import"./index.BLAVLI0k.js";import"./scroll.BNYtayPk.js";const N={key:0,class:"el-upload-list__item-info"},L=["onClick"],U={class:"el-upload-list__item-file-name"},W=["onClick"],D={key:1,class:"el-upload-list__item-info"},P=M(e({__name:"FileUpload",props:t({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},limit:{type:Number,default:10},maxFileSize:{type:Number,default:10},accept:{type:String,default:"*"},uploadBtnText:{type:String,default:"上传文件"},style:{type:Object,default:()=>({width:"300px"})}},{modelValue:{type:[Array],required:!0,default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=e,h=l(e,"modelValue"),b=a([]);function j(e){return!(e.size>1024*t.maxFileSize*1024)||(_.warning("上传文件不能大于"+t.maxFileSize+"M"),!1)}function x(e){return new Promise((l,a)=>{const s=e.file,i=new FormData;i.append(t.name,s),Object.keys(t.data).forEach(e=>{i.append(e,t.data[e])}),V.upload(i,e=>{const t=s.uid,l=b.value.find(e=>e.uid===t);l&&(l.percentage=e)}).then(e=>{l(e)}).catch(e=>{a(e)})})}function w(){_.warning(`最多只能上传${t.limit}个文件`)}s(h,e=>{b.value=e.map(e=>({name:e.name?e.name:e.url?.substring(e.url.lastIndexOf("/")+1),url:e.url,status:"success",uid:Date.now()<<13|Math.floor(8192*Math.random())}))},{immediate:!0});const k=(e,t,l)=>{if(_.success("上传成功"),l.every(e=>"success"===e.status||"fail"===e.status)){const e=[];l.map(t=>{if("success"===t.status){const l=t.response;l&&e.push({name:l.name,url:l.url})}else b.value.splice(b.value.findIndex(e=>e.uid===t.uid),1)}),e.length>0&&(h.value=[...h.value,...e])}},C=e=>{_.error("上传失败")};return(e,l)=>{const a=z,s=i("Document"),_=v,M=i("Close"),O=S,E=F;return n(),u("div",null,[r(E,{"file-list":p(b),"onUpdate:fileList":l[0]||(l[0]=e=>d(b)?b.value=e:null),style:o(t.style),"before-upload":j,"http-request":x,"on-success":k,"on-error":C,"on-exceed":w,accept:t.accept,limit:t.limit,multiple:""},{file:c(({file:e})=>["success"===e.status?(n(),u("div",N,[y("a",{class:"el-upload-list__item-name",onClick:t=>function(e){const{url:t,name:l}=e;t&&V.download(t,l)}(e)},[r(_,null,{default:c(()=>[r(s)]),_:1}),y("span",U,f(e.name),1),y("span",{class:"el-icon--close",onClick:g(t=>{return l=e.url,void V.delete(l).then(()=>{h.value=h.value.filter(e=>e.url!==l)});var l},["stop"])},[r(_,null,{default:c(()=>[r(M)]),_:1})],8,W)],8,L)])):(n(),u("div",D,[r(O,{style:{display:"inline-flex"},percentage:e.percentage},null,8,["percentage"])]))]),default:c(()=>[r(a,{type:"primary",disabled:p(b).length>=t.limit},{default:c(()=>[m(f(t.uploadBtnText),1)]),_:1},8,["disabled"])]),_:1},8,["file-list","style","accept","limit"])])}}}),[["__scopeId","data-v-2cecc892"]]),q=M(e({__name:"SingleImageUpload",props:t({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},maxFileSize:{type:Number,default:10},accept:{type:String,default:"image/*"},style:{type:Object,default:()=>({width:"150px",height:"150px"})}},{modelValue:{type:String,default:()=>""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){h(e=>({fd0a4d94:t.style.width??"150px",v3abc15b1:t.style.height??"150px"}));const t=e,a=l(e,"modelValue");function s(e){return t.accept.split(",").map(e=>e.trim()).some(t=>"image/*"===t?e.type.startsWith("image/"):t.startsWith(".")?e.name.toLowerCase().endsWith(t):e.type===t)?!(e.size>1024*t.maxFileSize*1024)||(_.warning("上传图片不能大于"+t.maxFileSize+"M"),!1):(_.warning(`上传文件的格式不正确，仅支持：${t.accept}`),!1)}function o(e){return new Promise((l,a)=>{const s=e.file,i=new FormData;i.append(t.name,s),Object.keys(t.data).forEach(e=>{i.append(e,t.data[e])}),V.upload(i).then(e=>{l(e)}).catch(e=>{a(e)})})}function p(){}function d(){a.value=""}const m=e=>{_.success("上传成功"),a.value=e.url},f=e=>{_.error("上传失败: "+e.message)};return(e,l)=>{const y=O,_=i("CircleCloseFilled"),h=v,x=i("Plus"),w=F;return n(),b(w,{class:"single-upload","list-type":"picture-card","show-file-list":!1,accept:t.accept,"before-upload":s,"http-request":o,"on-success":m,"on-error":f},{default:c(()=>[a.value?(n(),u(j,{key:0},[r(y,{class:"single-upload__image",src:a.value,"preview-src-list":[a.value],onClick:g(p,["stop"])},null,8,["src","preview-src-list"]),r(h,{class:"single-upload__delete-btn",onClick:g(d,["stop"])},{default:c(()=>[r(_)]),_:1})],64)):(n(),b(h,{key:1},{default:c(()=>[r(x)]),_:1}))]),_:1},8,["accept"])}}}),[["__scopeId","data-v-0052e504"]]),A={style:{width:"100%"}},H=["src"],G={class:"el-upload-list__item-actions"},K=["onClick"],Q=["onClick"],Z=e({__name:"MultiImageUpload",props:t({data:{type:Object,default:()=>({})},name:{type:String,default:"file"},limit:{type:Number,default:10},maxFileSize:{type:Number,default:10},accept:{type:String,default:"image/*"}},{modelValue:{type:[Array],default:()=>[]},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const t=e,s=a(!1),o=a(0),m=l(e,"modelValue"),f=a([]);function g(e){return t.accept.split(",").map(e=>e.trim()).some(t=>"image/*"===t?e.type.startsWith("image/"):t.startsWith(".")?e.name.toLowerCase().endsWith(t):e.type===t)?!(e.size>1024*t.maxFileSize*1024)||(_.warning("上传图片不能大于"+t.maxFileSize+"M"),!1):(_.warning(`上传文件的格式不正确，仅支持：${t.accept}`),!1)}function h(e){return new Promise((l,a)=>{const s=e.file,i=new FormData;i.append(t.name,s),Object.keys(t.data).forEach(e=>{i.append(e,t.data[e])}),V.upload(i).then(e=>{l(e)}).catch(e=>{a(e)})})}function k(){_.warning("最多只能上传"+t.limit+"张图片")}const C=(e,t)=>{_.success("上传成功");const l=f.value.findIndex(e=>e.uid===t.uid);-1!==l&&(f.value[l].url=e.url,f.value[l].status="success",m.value[l]=e.url)},S=e=>{_.error("上传失败: "+e.message)},z=()=>{s.value=!1};return x(()=>{f.value=m.value.map(e=>({url:e}))}),(e,l)=>{const a=i("Plus"),_=v,x=i("zoom-in"),M=i("Delete"),O=F,I=E;return n(),u(j,null,[r(O,{"file-list":p(f),"onUpdate:fileList":l[0]||(l[0]=e=>d(f)?f.value=e:null),"list-type":"picture-card","before-upload":g,"http-request":h,"on-success":C,"on-error":S,"on-exceed":k,accept:t.accept,limit:t.limit,multiple:""},{file:c(({file:e})=>[y("div",A,[y("img",{class:"el-upload-list__item-thumbnail",src:e.url},null,8,H),y("span",G,[y("span",{onClick:t=>{return l=e.url,o.value=m.value.findIndex(e=>e===l),void(s.value=!0);var l}},[r(_,null,{default:c(()=>[r(x)]),_:1})],8,K),y("span",{onClick:t=>{return l=e.url,void V.delete(l).then(()=>{const e=m.value.indexOf(l);-1!==e&&(m.value.splice(e,1),f.value.splice(e,1))});var l}},[r(_,null,{default:c(()=>[r(M)]),_:1})],8,Q)])])]),default:c(()=>[r(_,null,{default:c(()=>[r(a)]),_:1})]),_:1},8,["file-list","accept","limit"]),p(s)?(n(),b(I,{key:0,"zoom-rate":1.2,"initial-index":p(o),"url-list":m.value,onClose:z},null,8,["initial-index","url-list"])):w("",!0)],64)}}}),$={class:"app-container"},B=e({__name:"upload",setup(e){const t=a("https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"),l=a(["https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"]),s=a([{name:"照片1.jpg",url:"https://s2.loli.net/2023/05/24/yNsxFC8rLHMZQcK.jpg"},{name:"照片2.jpg",url:"https://s2.loli.net/2023/05/24/RuHFMwW4rG5lIqs.jpg"}]);return(e,a)=>{const i=I,o=q,f=k,y=P,v=C;return n(),u("div",$,[r(i,{href:"https://gitee.com/youlaiorg/vue3-element-admin/blob/master/src/views/demo/upload.vue",type:"primary",target:"_blank",class:"mb-10"},{default:c(()=>[...a[3]||(a[3]=[m(" 示例源码 请点击>>>> ",-1)])]),_:1}),r(v,null,{default:c(()=>[r(f,{label:"单图上传"},{default:c(()=>[r(o,{modelValue:p(t),"onUpdate:modelValue":a[0]||(a[0]=e=>d(t)?t.value=e:null)},null,8,["modelValue"])]),_:1}),r(f,{label:"多图上传"},{default:c(()=>[r(Z,{modelValue:p(l),"onUpdate:modelValue":a[1]||(a[1]=e=>d(l)?l.value=e:null),limit:2},null,8,["modelValue"])]),_:1}),r(f,{label:"文件上传"},{default:c(()=>[r(y,{modelValue:p(s),"onUpdate:modelValue":a[2]||(a[2]=e=>d(s)?s.value=e:null)},null,8,["modelValue"])]),_:1})]),_:1})])}}});export{B as default};
