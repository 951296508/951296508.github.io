import{d as e,aE as a,aJ as l,ap as r,o,r as s,cR as t,c as i,dJ as n,as as d,g as p,f as u,C as m,m as c,F as g,i as f,w as v,E as x,a3 as h,e as _,a4 as j,ay as y}from"./index.CLwcgr5W.js";import{E as w,a as b}from"./form-item.BdtRMIsU.js";/* empty css               */import{E as C}from"./link.BAAqDnnc.js";import{E as V}from"./checkbox.Bca_-ShR.js";import{E as k}from"./text.DjrpDA4A.js";/* empty css                */import{E as q}from"./popper.ri2OTzpA.js";import{E}from"./input.Dut2d9w2.js";import{C as M}from"./index.BkpUpnH1.js";import{E as U}from"./index.CBGhulza.js";import{_ as K}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./use-form-common-props.IVgy7ztC.js";import"./castArray.DrI1MKdu.js";import"./error.D_Dr4eZ1.js";import"./_baseClone.CAv3GKzL.js";import"./index.VqkEunCr.js";import"./index.WPFncA80.js";import"./event.BwRzfsZt.js";import"./omit.Ya0hPkRo.js";import"./index.QOGYTTN0.js";import"./aria.Cpd_B0tV.js";import"./index.B4fcRE25.js";import"./index.BLAVLI0k.js";import"./index.BEOFtOgx.js";const L={"text-center":"","m-0":"","mb-20px":""},R={flex:"","items-center":"","gap-10px":""},z=["src"],P={class:"flex-x-between w-full"},A={"flex-center":"","gap-10px":""},F={class:"third-party-login"},I={class:"divider-container"},J={class:"divider-text"},B={class:"flex-center gap-x-5 w-full text-[var(--el-text-color-secondary)]"},D=K(e({__name:"Login",emits:["update:modelValue"],setup(e,{emit:K}){const{t:D}=a(),H=l(),O=r();o(()=>Z());const S=s(),W=s(!1),X=s(!1),G=s(),N=t.getRememberMe(),Q=s({username:"admin",password:"123456",captchaKey:"",captchaCode:"",rememberMe:N}),T=i(()=>({username:[{required:!0,trigger:"blur",message:D("login.message.username.required")}],password:[{required:!0,trigger:"blur",message:D("login.message.password.required")},{min:6,message:D("login.message.password.min"),trigger:"blur"}],captchaCode:[{required:!0,trigger:"blur",message:D("login.message.captchaCode.required")}]})),Y=s(!1);function Z(){Y.value=!0,n.getCaptcha().then(e=>{Q.value.captchaKey=e.captchaKey,G.value=e.captchaBase64}).finally(()=>Y.value=!1)}async function $(){try{if(!(await(S.value?.validate())))return;W.value=!0,await H.login(Q.value);const e=O.query.redirect||"/";await y.push(decodeURIComponent(e))}catch(e){Z()}finally{W.value=!1}}function ee(e){e instanceof KeyboardEvent&&(X.value=e.getModifierState("CapsLock"))}const ae=K;function le(e){ae("update:modelValue",e)}return(e,a)=>{const l=d("User"),r=x,o=E,s=w,t=d("Lock"),i=q,n=d("Loading"),y=k,K=V,H=C,O=U,N=b;return u(),p("div",null,[m("h3",L,g(f(D)("login.login")),1),c(N,{ref_key:"loginFormRef",ref:S,model:f(Q),rules:f(T),size:"large","validate-on-rule-change":!1},{default:v(()=>[c(s,{prop:"username"},{default:v(()=>[c(o,{modelValue:f(Q).username,"onUpdate:modelValue":a[0]||(a[0]=e=>f(Q).username=e),modelModifiers:{trim:!0},placeholder:f(D)("login.username")},{prefix:v(()=>[c(r,null,{default:v(()=>[c(l)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1}),c(i,{visible:f(X),content:f(D)("login.capsLock"),placement:"right"},{default:v(()=>[c(s,{prop:"password"},{default:v(()=>[c(o,{modelValue:f(Q).password,"onUpdate:modelValue":a[1]||(a[1]=e=>f(Q).password=e),modelModifiers:{trim:!0},placeholder:f(D)("login.password"),type:"password","show-password":"",onKeyup:[ee,h($,["enter"])]},{prefix:v(()=>[c(r,null,{default:v(()=>[c(t)]),_:1})]),_:1},8,["modelValue","placeholder"])]),_:1})]),_:1},8,["visible","content"]),c(s,{prop:"captchaCode"},{default:v(()=>[m("div",R,[c(o,{modelValue:f(Q).captchaCode,"onUpdate:modelValue":a[2]||(a[2]=e=>f(Q).captchaCode=e),modelModifiers:{trim:!0},placeholder:f(D)("login.captchaCode"),clearable:"",class:"flex-1",onKeyup:h($,["enter"])},{prefix:v(()=>[...a[6]||(a[6]=[m("div",{class:"i-svg:captcha"},null,-1)])]),_:1},8,["modelValue","placeholder"]),m("div",{"cursor-pointer":"","h-40px":"","w-120px":"","flex-center":"",onClick:Z},[f(Y)?(u(),_(r,{key:0,class:"is-loading",size:"20"},{default:v(()=>[c(n)]),_:1})):f(G)?(u(),p("img",{key:1,"border-rd-4px":"","object-cover":"",shadow:"[0_0_0_1px_var(--el-border-color)_inset]",src:f(G),alt:"captchaCode"},null,8,z)):(u(),_(y,{key:2,type:"info",size:"small"},{default:v(()=>[...a[7]||(a[7]=[j("点击获取验证码",-1)])]),_:1}))])])]),_:1}),m("div",P,[c(K,{modelValue:f(Q).rememberMe,"onUpdate:modelValue":a[3]||(a[3]=e=>f(Q).rememberMe=e)},{default:v(()=>[j(g(f(D)("login.rememberMe")),1)]),_:1},8,["modelValue"]),c(H,{type:"primary",underline:"never",onClick:a[4]||(a[4]=e=>le("resetPwd"))},{default:v(()=>[j(g(f(D)("login.forgetPassword")),1)]),_:1})]),c(s,null,{default:v(()=>[c(O,{loading:f(W),type:"primary",class:"w-full",onClick:$},{default:v(()=>[j(g(f(D)("login.login")),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]),m("div",A,[c(y,{size:"default"},{default:v(()=>[j(g(f(D)("login.noAccount")),1)]),_:1}),c(H,{type:"primary",underline:"never",onClick:a[5]||(a[5]=e=>le("register"))},{default:v(()=>[j(g(f(D)("login.reg")),1)]),_:1})]),m("div",F,[m("div",I,[a[8]||(a[8]=m("div",{class:"divider-line"},null,-1)),m("span",J,g(f(D)("login.otherLoginMethods")),1),a[9]||(a[9]=m("div",{class:"divider-line"},null,-1))]),m("div",B,[c(M,null,{default:v(()=>[...a[10]||(a[10]=[m("div",{"text-20px":"",class:"i-svg:wechat"},null,-1)])]),_:1}),c(M,null,{default:v(()=>[...a[11]||(a[11]=[m("div",{"text-20px":"","cursor-pointer":"",class:"i-svg:qq"},null,-1)])]),_:1}),c(M,null,{default:v(()=>[...a[12]||(a[12]=[m("div",{"text-20px":"","cursor-pointer":"",class:"i-svg:github"},null,-1)])]),_:1}),c(M,null,{default:v(()=>[...a[13]||(a[13]=[m("div",{"text-20px":"","cursor-pointer":"",class:"i-svg:gitee"},null,-1)])]),_:1})])])])}}}),[["__scopeId","data-v-5408e34b"]]);export{D as default};
